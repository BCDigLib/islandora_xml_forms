<?php

// $Id$

/**
 * @file
 * 
 * Unit Tests.
 */

/**
 * Unit Tests for the FormControl class.
 */
class SchemaAPI_InsertOrderMap_TestCase extends DrupalUnitTestCase {

  /**
   * Get Test info.
   *
   * @return array
   * Properties that are displayed in the test selection form.
   */
  public static function getInfo() {
    return array(
      'name' => 'InsertOrderMap Unit Tests.',
      'description' => 'Unit tests for InsertOrderMap.inc',
      'group' => 'Schema API',
    );
  }

  /**
   * setUp() performs any pre-requisite tasks that need to happen. 
   */
  public function setUp() {
    // Enable any modules required for the test.
    parent::setUp('schema_api');
    module_load_include('inc', 'schema_api', 'InsertOrderMap');
  }

  /**
   *
   */
  public function test() {
    $path = drupal_get_path('module', 'schema_api');
    $schema = new XMLSchema($path . '/tests/data/schemas/fgdc-std-001-1998.xsd');
    $this->assertNotNull($schema);
    $path = '/xsd:schema/xsd:element[@name=\'idinfo\']'; // Path to the idinfo element.
    $insert_map = new XMLSchemaInsertOrderMap($schema, $path);
    $this->assertNotNull($insert_map);
    $map = $insert_map->map;
    $this->assertNotNull($map); // Map exists.
    $this->assertNull($map->parent, 'Top level doesn\'t have parent.'); // Top level doesn't have parent.
    $this->assertEqual($map->min, 1, 'Min value set correctly');
    $this->assertEqual($map->max, 1, 'Max value set correctly');
    $this->assertEqual($map->type, 'compositor', 'Type set correctly');
    $this->assertEqual($map->compositor, 'sequence', 'Compositor is of type sequence.');
    $this->assertEqual($map->element, NULL, 'Element correctly set to NULL');
    $this->assertEqual(count($map->children), 14, 'Correct Number of children.');
    
  }

}